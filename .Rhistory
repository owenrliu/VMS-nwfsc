calc_ntraps <- function(seg_length){
floor(seg_length*15)
}
# create segments
trip1_lines <- trip1_trunc %>%
summarise(do_union=FALSE) %>%
st_cast("LINESTRING") %>%
st_segmentize(units::set_units(1/15,miles))
trip1_traps_opt2 <- trip1_lines[[1]]
ggplot()+
geom_sf(data=trip1_lines,col='black')+
geom_sf(data=trip1_traps_opt2,col='black',size=0.5)
plot(trip1_traps_opt2)
?st_cast
trip1_traps_opt2 <- trip1_lines[[1]] %>% st_cast("POINT")
ggplot()+
geom_sf(data=trip1_lines,col='black')+
geom_sf(data=trip1_traps_opt2,col='black',size=0.5)
ggplot()+
geom_sf(data=trip1_lines,col='black')+
geom_sf(data=trip1_traps_opt2,col='blue',size=0.3)
ggplot()+
geom_sf(data=trip1_lines,col='black',size=1.5)+
geom_sf(data=trip1_traps_opt2,col='blue',size=0.3)
ggplot()+
geom_sf(data=trip1_traps_opt2,col='blue',size=0.3)
ggplot()+
geom_sf(data=trip1_traps_opt2,col='blue',size=0.3)+
labs(x="Longitude",y="Latitude",title="A DCRB Trip\nDec 02, 2010\nLinear Trap Placement")
View(trip1_dists)
4*15
ggplot()+
geom_sf(data=trip1_hull,fill='darkblue',alpha=0.5)+
geom_sf(data=trip1_traps_opt1,col='black',size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,col='blue',size=0.3)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(color="Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(color="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(color="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols)+scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
cols <- c("Random"="black","Linear"="blue","Hull"="darkblue")
ggplot()+
geom_sf(data=trip1_hull,aes(color="Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(color="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(color="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols)+scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
cols
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(color="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(color="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols)+scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(fill="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(fill="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols)+scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols)+scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
cols <- c("Random"="black","Linear"="blue","Convex Hull"="darkblue")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols)+scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,guide=guide_legend(override.aes = list(shape=16)))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,guide=guide_legend(override.aes = list(shape=16)))+
scale_fill_manual(name="",values=cols,guide=guide_legend(override.aes = list(shape=16)))+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
?guide_legened
?guide_legend
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,guide=guide_legend(override.aes = list(shape=16)))+
scale_fill_manual(name="",values=cols,guide=guide_legend(override.aes = list(shape=c(16,16))))+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,guide=guide_legend(override.aes = list(shape=c(16,16))))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
cols <- c("Random"="black","Linear"="blue","Convex Hull"="darkblue")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,guide=guide_legend(override.aes = list(shape=c(16,16))))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,
guide=guide_legend(override.aes = list(shape=c(16,16),linetype=c(rep('blank',2)))))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
?override.aes
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,
guide=guide_legend(override.aes = list(shape=c(10,10),linetype=c(rep('blank',2)))))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random",shape="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear",shape="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c(rep('blank',2)))))+
scale_shape_manual(name="Type",values=shapes)+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
cols <- c("Random"="black","Linear"="blue","Convex Hull"="darkblue")
shapes <- c("Random"=16,"Linear"=16)
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random",shape="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear",shape="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c(rep('blank',2)))))+
scale_shape_manual(name="Type",values=shapes)+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random",shape="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear",shape="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c(rep('blank',2)))))+
scale_shape_manual(name="Type",values=shapes,
guide=guide_legend(override.aes = list(shape=c(rep(16,2)))))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
cols <- c("Random"="black","Linear"="blue","Convex Hull"="darkblue")
shapes <- c("Random"=16,"Linear"=16)
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random",shape="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear",shape="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c(rep('blank',2)))))+
scale_shape_manual(name="Type",values=shapes,
guide=guide_legend(override.aes = list(shape=c(rep(16,2)))))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
cols <- c("Random"="black","Linear"="blue","Convex Hull"="darkblue")
shapes <- c("Random"=16,"Linear"=16)
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random",shape="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear",shape="Linear"),size=0.3)+
scale_shape_manual(name="Type",values=shapes,
guide=guide_legend(override.aes = list(shape=c(rep(16,2)))))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random",shape="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear",shape="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c(rep('blank',2)))))+
scale_shape_manual(name="Type",values=shapes,
guide=guide_legend(override.aes = list(shape=c(rep(16,2)))))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c(rep('blank',2)),shape=c(rep(16,2)))))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c(rep('blank',2)),shape=c(rep(16,2)),size=rep(5,2))))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c(rep('blank',2)),shape=16,size=3)))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c(rep('blank',2)),shape=16,size=6)))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,
guide=guide_legend(override.aes = list(shape=16,size=6)))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(col="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(col="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,
guide=guide_legend(override.aes = list(shape=21,size=6)))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
?geom_sf
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(colour="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(colour="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,
guide=guide_legend(override.aes = list(shape=21,size=6)))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
cols <- c("Random"="black","Linear"="blue","Convex Hull"="darkblue")
shapes <- c("Random"=16,"Linear"=16)
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(colour="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(colour="Linear"),size=0.3)+
scale_color_manual(name="Type",values=cols,
guide=guide_legend(override.aes = list(shape=21,size=6)))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
?guide_legend
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(colour="Random"),size=0.5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(colour="Linear"),size=0.3)+
scale_color_manual(name="Trap Placement Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c('blank','blank'),shape=21,size=6)))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(colour="Random"),size=0.5,shape=21)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(colour="Linear"),size=0.3,shape=21)+
scale_color_manual(name="Trap Placement Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c('blank','blank'),shape=21,size=6)))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(colour="Random"),size=0.5,shape=5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(colour="Linear"),size=0.3,shape=5)+
scale_color_manual(name="Trap Placement Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c('blank','blank'),shape=21,size=6)))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(colour="Random",shape="Random"),size=0.5,shape=5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(colour="Linear",shape="Linear"),size=0.3)+
scale_color_manual(name="Trap Placement Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c('blank','blank'))))+
scale_shape_manual(name="Trap Placement Type",values=shapes)+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(colour="Random",shape="Random"),size=0.5,shape=5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(colour="Linear",shape="Linear"),size=0.3)+
scale_color_manual(name="Trap Placement Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c('blank','blank'))))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(colour="Random"),size=0.5,shape=5)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(colour="Linear"),size=0.3)+
scale_color_manual(name="Trap Placement Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c('blank','blank'))))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(colour="Random"),size=0.5,shape=16)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(colour="Linear"),size=0.3)+
scale_color_manual(name="Trap Placement Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c('blank','blank'))))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(colour="Random"),size=0.5,shape=16)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(colour="Linear"),size=0.3,shape=16)+
scale_color_manual(name="Trap Placement Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c('blank','blank'))))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
bbox=st_bbox(trip1_trunc)
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(colour="Random"),size=0.5,shape=16)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(colour="Linear"),size=0.3,shape=16)+
scale_color_manual(name="Trap Placement Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c('blank','blank'))))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(colour="Random"),size=0.5,shape=16)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(colour="Linear"),size=0.3,shape=5)+
scale_color_manual(name="Trap Placement Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c('blank','blank'))))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(colour="Random"),size=0.5,shape=16)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(colour="Linear"),size=0.3,shape=5)+
scale_color_manual(name="Trap Placement Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c('blank','blank'))))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
cols <- c("Random"="black","Linear"="blue","Convex Hull"="darkblue")
shapes <- c("Random"=16,"Linear"=16)
bbox=st_bbox(trip1_trunc)
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(colour="Random"),size=0.5,shape=16)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(colour="Linear"),size=0.3,shape=16)+
scale_color_manual(name="Trap Placement Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c('blank','blank'))))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
ggplot()+
geom_sf(data=trip1_hull,aes(fill="Convex Hull"),col=NA,alpha=0.5)+
geom_sf(data=trip1_traps_opt1,aes(colour="Random"),size=0.5,shape=16)+
geom_sf(data=coaststates,color='gray50')+
geom_sf(data=trip1_traps_opt2,aes(colour="Linear"),size=0.3,shape=16)+
scale_color_manual(name="Trap Placement Type",values=cols,
guide=guide_legend(override.aes = list(linetype=c('blank','blank'))))+
scale_fill_manual(name="",values=cols)+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coast))+
labs(x="Longitude",y="Latitude",title="Random versus Linear Trap Placement")
trip1 <- vms_sf %>%
filter(TARGET_max=="DCRB",year(westcoastdate)==2010,month(westcoastdate)==12) %>%
group_by(Rec_ID) %>%
nest() %>%
ungroup() %>%
slice(100) %>%
unnest(cols = c(data)) %>%
st_as_sf(crs=st_crs(vms_sf)) %>%
st_transform(4326)
bbox <- st_bbox(trip1)
# plot
# sptable for drawing paths
trip_tbl <- trip1 %>%
spbabel::sptable()
ggplot()+
geom_path(data=trip_tbl,aes(x_,y_),color="black")+
geom_sf(data=coaststates,color='gray50')+
theme(axis.text.x = element_text(angle=45))+
coord_sf(xlim=c(bbox[1],bbox[3]),ylim=c(bbox[2],bbox[4]),crs=st_crs(coaststates))+
labs(x="Longitude",y="Latitude",title="A DCRB Trip\nDec 02, 2010")
