years
years <- 2009:2018
keeps <- c('vms_orig_clean','vms_int_reg','vms_int_all','fp','fp_tix','years','fishtix_basic_all')
rm(list=setdiff(ls(),keeps))
for(i in years){
tempname <- paste0('fishtix_vms_matched_',i)
tempout <- read_csv(paste0(fp_tix,'VMS-Matched (Step 5)/','FishTix_wVMS_10d_lookback_',i,'.csv'),col_types = cols())
assign(tempname,tempout)
}
# throws a couple of readr errors here, but they are only in one column (gear code, ) which we do not offically need anyway
fishtix_matched_all <- bind_rows(fishtix_vms_matched_2009,fishtix_vms_matched_2010,fishtix_vms_matched_2011,fishtix_vms_matched_2012,fishtix_vms_matched_2013,fishtix_vms_matched_2014,fishtix_vms_matched_2015,fishtix_vms_matched_2016,fishtix_vms_matched_2017,fishtix_vms_matched_2018)
keeps <- c('vms_orig_clean','vms_int_reg','vms_int_all','fp','fp_tix','years','fishtix_basic_all')
rm(list=setdiff(ls(),keeps))
for(i in years){
tempname <- paste0('fishtix_vms_matched_',i)
tempout <- read_csv(paste0(fp_tix,'VMS-Matched (Step 5)/','FishTix_wVMS_10d_lookback_',i,'.csv'),col_types = cols(gear_code_all='i'))
assign(tempname,tempout)
}
# throws a couple of readr errors here, but they are only in one column (gear code, ) which we do not offically need anyway
fishtix_matched_all <- bind_rows(fishtix_vms_matched_2009,fishtix_vms_matched_2010,fishtix_vms_matched_2011,fishtix_vms_matched_2012,fishtix_vms_matched_2013,fishtix_vms_matched_2014,fishtix_vms_matched_2015,fishtix_vms_matched_2016,fishtix_vms_matched_2017,fishtix_vms_matched_2018)
rm(list=ls()[!(ls() %in% c('fishtix_basic_all','vms_matched_all'))])
keeps <- c('vms_orig_clean','vms_int_reg','vms_int_all','fp','fp_tix','years','fishtix_basic_all')
rm(list=setdiff(ls(),keeps))
for(i in years){
tempname <- paste0('fishtix_vms_matched_',i)
tempout <- read_csv(paste0(fp_tix,'VMS-Matched (Step 5)/','FishTix_wVMS_10d_lookback_',i,'.csv'),col_types = cols(gear_code_all='i'))
assign(tempname,tempout)
}
years <- 2009:2018
fp_tix <- "C:/Users/owenr/Documents/postdocs/NOAA NRC/NWFSC work/VMS DATA CONFIDENTIAL/Processed Data/Fish tickets/"
keeps <- c('vms_orig_clean','vms_int_reg','vms_int_all','fp','fp_tix','years','fishtix_basic_all')
rm(list=setdiff(ls(),keeps))
for(i in years){
tempname <- paste0('fishtix_vms_matched_',i)
tempout <- read_csv(paste0(fp_tix,'VMS-Matched (Step 5)/','FishTix_wVMS_10d_lookback_',i,'.csv'),col_types = cols(gear_code_all='i'))
assign(tempname,tempout)
}
# throws a couple of readr errors here, but they are only in one column (gear code, ) which we do not offically need anyway
fishtix_matched_all <- bind_rows(fishtix_vms_matched_2009,fishtix_vms_matched_2010,fishtix_vms_matched_2011,fishtix_vms_matched_2012,fishtix_vms_matched_2013,fishtix_vms_matched_2014,fishtix_vms_matched_2015,fishtix_vms_matched_2016,fishtix_vms_matched_2017,fishtix_vms_matched_2018)
rm(list=ls()[!(ls() %in% c('fishtix_basic_all','fishtix_matched_all'))])
save.image(file=paste0(fp,"VMS_2009_2018_clean.RData"))
# These are large data files, so this will take awhile
# base file path on my computer
fp <- "C:/Users/owenr/Documents/postdocs/NOAA NRC/NWFSC work/VMS DATA CONFIDENTIAL/Processed Data/VMS/"
fp_fishtix
fp_tix
fp_tix <- "C:/Users/owenr/Documents/postdocs/NOAA NRC/NWFSC work/VMS DATA CONFIDENTIAL/Processed Data/Fish tickets/"
rm(list=ls()[!(ls() %in% c('fishtix_basic_all','fishtix_matched_all','fp_tix'))])
save.image(file=paste0(fp,"VMS_2009_2018_clean.RData"))
rm(list=ls()[!(ls() %in% c('fishtix_basic_all','fishtix_matched_all','fp_tix'))])
save.image(file=paste0(fp_tix,"FishTix_all_2009_2018.RData"))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(sf)
library(here)
library(fasterize)
library(raster)
library(rnaturalearth)
# clean, interpolated vms data
vms <- read_csv("C:/Users/owenr/Documents/postdocs/NOAA NRC/NWFSC work/VMS DATA CONFIDENTIAL/Processed Data/VMS/VMS_Outputs_wTARGET_10d_lookback_2011_final_cleaned_interpolated_regular.csv",col_types='dcTddccddTDdccccd')
# 5x5 grid shapefile
grd <- read_sf(here::here("Input_Data","5x5 Grid","five_km_grid_polys_geo.shp"))
names(grd)
# convert vms to spatial object
vms_sf <- vms %>%
st_as_sf(coords=c('LONGITUDE','LATITUDE'),crs=4326)
# do the join
pt <- proc.time()
vms_grd_match <- vms_sf %>%
st_join(grd)
proc.time()-pt
names(vms_grd_match)
length(unique(vms_grd_match$GRID5KM_ID))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(sf)
library(here)
library(fasterize)
library(raster)
library(rnaturalearth)
# clean, interpolated vms data
vms <- read_csv("C:/Users/owenr/Documents/postdocs/NOAA NRC/NWFSC work/VMS DATA CONFIDENTIAL/Processed Data/VMS/VMS_Outputs_wTARGET_10d_lookback_2009_final_cleaned_interpolated_regular.csv",col_types='dcTddccddTDdccccd')
# 5x5 grid shapefile
# grd <- read_sf(here::here("Input_Data","5x5 Grid","five_km_grid_polys_geo.shp"))
grd <- read_sf(here::here("Input_Data","5x5 Grid","regions_master_final_lamb.shp"))
names(grd)
meta <- readxl::read_xlsx(here::here("Input Data","5x5 Grid","regions_master_final_lamb_metadata.xlsx"))
?read_xlsx
meta <- readxl::read_xlsx(here::here("Input_Data","5x5 Grid","regions_master_final_lamb_metadata.xlsx"))
View(meta)
library(knitr)
meta <- readxl::read_xlsx(here::here("Input_Data","5x5 Grid","regions_master_final_lamb_metadata.xlsx")) %>% kable()
meta
st_crs(grd)
# convert vms to spatial object (longitude/latitude)
vms_sf <- vms %>%
st_as_sf(coords=c('LONGITUDE','LATITUDE'),crs=4326) %>%
# then, convert to planar projection to match the grid
st_transform(st_crs(grd))
# do the join
pt <- proc.time()
vms_grd_match <- vms_sf %>%
st_join(grd)
proc.time()-pt
names(vms_grd_match)
length(unique(vms_grd_match$GRID5KM_ID))
names(vms_grd_match)
length(unique(vms_grd_match$GRID5KM_ID))
length(unique(vms_grd_match$BAND_25KM))
length(unique(vms_grd_match$BAND_50KM))
class(grd)
# write a non-spatial version of the joined data
vms_grd <- vms_grd_match
st_geometry(vms_grd) <- NULL
write_csv(vms_grd,"C:/Users/owenr/Documents/postdocs/NOAA NRC/NWFSC work/VMS DATA CONFIDENTIAL/Processed Data/VMS/VMS_Outputs_wTARGET_10d_lookback_2009_final_cleaned_interpolated_regular_w_5k_grid.csv")
# clear wrkspace
rm(list=setdiff(ls(),'grd'))
?load
# load RData
fp <- "C:/Users/owenr/Documents/postdocs/NOAA NRC/NWFSC work/VMS DATA CONFIDENTIAL/Processed Data/VMS/"
load(file=paste0(fp,"VMS_2009_2018_clean.RData"))
# convert VMS to spatial object
pt <- proc.time()
vms_all_sf <- vms_int_all %>%
st_as_sf(coords=c('LONGITUDE','LATITUDE'),crs=4326) %>%
# then, convert to planar projection to match the grid
st_transform(st_crs(grd))
proc.time()-pt
419/60
# do the join
pt <- proc.time()
vms_all_grd_match <- vms_all_sf %>%
st_join(grd)
# convert VMS to spatial object
pt <- proc.time()
vms_all_sf <- vms_int_reg %>%
st_as_sf(coords=c('LONGITUDE','LATITUDE'),crs=4326) %>%
# then, convert to planar projection to match the grid
st_transform(st_crs(grd))
install.packages('tidyverse')
install.packages('sf')
install.packages(c("fasterize", "here", "raster", "rnaturalearth", "sf"))
library(sf)
install.packages(c("fasterize","here","raster","rnaturalearth"))
install.packages(c("extrafont", "ggsci"))
extrafont::loadfonts()
extrafont::fonts()
extrafont::loadfonts()
library(extrafont)
loadfonts()
fonts()
font_import()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
library(extrafont)
library(ggsci)
library(lubridate)
# ggplot theme
plot_theme <-   theme_minimal()+
theme(text=element_text(family="Gill Sans MT",size=12,color="black"),
legend.text = element_text(size=14),
axis.title=element_text(family="sans",size=14,color="black"),
axis.text=element_text(family="sans",size=8,color="black"),
panel.grid.major = element_line(color="gray50",linetype=3))
theme_set(plot_theme)
# File path where data are held
fp <- "C:/Users/Owen.Liu/Documents/NWFSC Research/Dungeness Fleet Dynamics/VMS DATA CONFIDENTIAL/Processed Data/VMS/"
fp_tix <- "C:/Users/Owen.Liu/Documents/NWFSC Research/Dungeness Fleet Dynamics/VMS DATA CONFIDENTIAL/Processed Data/Fish tickets/"
# Load Rdata files
# Interpolated, regularized VMS data, all years
vms<-readRDS(file=paste0(fp,"VMS_int_reg_w_grid.rds"))
# fish ticket data
load(file=paste0(fp_tix,"FishTix_all_2009_2018.RData"))
# Summarize fish tickets by target species as defined above, and denote whether each trip is multispecies
fishtix <- fishtix_basic_all %>%
# start with all fishtickets for the year
select(Rec_ID,pacfin_port_code,drvid,date,TARGET,DCRB..lbs.,LOBS..lbs.,SABL..lbs.,SPRW..lbs.,OtherGear..lbs., Other..lbs.) %>%
#rename port
rename(Port_Of_Landing=pacfin_port_code) %>%
# group by vessel
group_by(drvid) %>%
arrange(desc(date),pmin(DCRB..lbs.,LOBS..lbs.,SABL..lbs.,SPRW..lbs.,OtherGear..lbs., Other..lbs.)) %>%
# For multiple-ticket days,
# define "TARGET" from the ticket with most landed pounds for that day, but also retain the other targets in a string
group_by(drvid, date) %>%
mutate(all_spp=paste(TARGET,sep='',collapse=''),sumlbs=DCRB..lbs.+LOBS..lbs.+SABL..lbs.+SPRW..lbs.+OtherGear..lbs.+Other..lbs.) %>%
top_n(1,wt=sumlbs) %>%
select(-sumlbs) %>%
ungroup() %>%
# denote whether a trip is multispecies (binary)
mutate(num_TARGET=nchar(all_spp)/4) %>%
mutate(date=as_date(date,format="%m/%d/%Y",tz="America/Los_Angeles")) %>%
mutate(month=month(date),year=year(date))
landings_by_month <- fishtix %>%
group_by(year,month) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup() %>%
mutate(day=1) %>%
unite(date,year,month,day,sep="-",remove = FALSE) %>%
mutate(date=as_date(date,format="%Y-%m-%d",tz="America/Los_Angeles"))
landings_by_month %>%
ggplot(aes(date,DCRB_lbs/1e6))+
geom_point()+
geom_line()+
labs(x="Date",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Month, all Tickets")
landings_by_year <- fishtix %>%
group_by(year) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup()
landings_by_year %>%
ggplot(aes(year,DCRB_lbs/1e6))+
geom_point()+
geom_line()+
ylim(0,NA)+
labs(x="Year",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Year, all Tickets")
loadfonts()
fonts()
landings_by_month <- fishtix %>%
group_by(year,month) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup() %>%
mutate(day=1) %>%
unite(date,year,month,day,sep="-",remove = FALSE) %>%
mutate(date=as_date(date,format="%Y-%m-%d",tz="America/Los_Angeles"))
landings_by_month %>%
ggplot(aes(date,DCRB_lbs/1e6))+
geom_point()+
geom_line()+
labs(x="Date",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Month, all Tickets")
landings_by_year <- fishtix %>%
group_by(year) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup()
landings_by_year %>%
ggplot(aes(year,DCRB_lbs/1e6))+
geom_point()+
geom_line()+
ylim(0,NA)+
labs(x="Year",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Year, all Tickets")
names(vms)
st_geometry(vms) <- NULL
names(vms)
names(fishtix)
vms_fishtix_join <- vms %>%
select(Rec_ID,westcoastdate) %>%
mutate(is_vms=1) %>%
right_join(fishtix,by=Rec_ID)
vms_fishtix_join <- vms %>%
select(Rec_ID,westcoastdate) %>%
mutate(is_vms=1) %>%
right_join(fishtix,by="Rec_ID")
vms_fishtix_join <- vms %>%
select(Rec_ID) %>%
distinct() %>%
mutate(is_vms=1) %>%
right_join(fishtix,by="Rec_ID")
sum(vms_fishtix_join$is_vms)
?coalesce
# Add an indicator to fishtickets if they have associated VMS data
vms_fishtix_join <- vms %>%
select(Rec_ID) %>%
distinct() %>%
mutate(is_vms=1) %>%
right_join(fishtix,by="Rec_ID") %>%
mutate(is_vms=replace_na(is_vms,0))
View(vms_fishtix_join)
landings_by_month <- vms_fishtix_join %>%
group_by(year,month,is_vms) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup() %>%
mutate(day=1) %>%
unite(date,year,month,day,sep="-",remove = FALSE) %>%
mutate(date=as_date(date,format="%Y-%m-%d",tz="America/Los_Angeles"))
landings_by_month %>%
ggplot(aes(date,DCRB_lbs/1e6))+
geom_point()+
geom_line()+
labs(x="Date",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Month, all Tickets")
landings_by_year <- vms_fishtix_join %>%
group_by(year,is_vms) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup()
landings_by_year %>%
ggplot(aes(year,DCRB_lbs/1e6))+
geom_point()+
geom_line()+
ylim(0,NA)+
labs(x="Year",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Year, all Tickets")
landings_by_month <- vms_fishtix_join %>%
group_by(year,month,is_vms) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup() %>%
mutate(day=1) %>%
unite(date,year,month,day,sep="-",remove = FALSE) %>%
mutate(date=as_date(date,format="%Y-%m-%d",tz="America/Los_Angeles"))
landings_by_month %>%
ggplot(aes(date,DCRB_lbs/1e6,group=is_vms))+
geom_point()+
geom_line()+
labs(x="Date",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Month, all Tickets")
landings_by_year <- vms_fishtix_join %>%
group_by(year,is_vms) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup()
landings_by_year %>%
ggplot(aes(year,DCRB_lbs/1e6,group=is_vms))+
geom_point()+
geom_line()+
ylim(0,NA)+
labs(x="Year",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Year, all Tickets")
landings_by_month <- vms_fishtix_join %>%
group_by(year,month,is_vms) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup() %>%
mutate(day=1) %>%
unite(date,year,month,day,sep="-",remove = FALSE) %>%
mutate(date=as_date(date,format="%Y-%m-%d",tz="America/Los_Angeles"))
landings_by_month %>%
ggplot(aes(date,DCRB_lbs/1e6,col=is_vms))+
geom_point()+
geom_line()+
labs(x="Date",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Month, all Tickets")
landings_by_year <- vms_fishtix_join %>%
group_by(year,is_vms) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup()
landings_by_year %>%
ggplot(aes(year,DCRB_lbs/1e6,col=is_vms))+
geom_point()+
geom_line()+
ylim(0,NA)+
labs(x="Year",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Year, all Tickets")
landings_by_month <- vms_fishtix_join %>%
group_by(year,month,is_vms) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup() %>%
mutate(day=1) %>%
unite(date,year,month,day,sep="-",remove = FALSE) %>%
mutate(date=as_date(date,format="%Y-%m-%d",tz="America/Los_Angeles"))
landings_by_month %>%
ggplot(aes(date,DCRB_lbs/1e6,col=factor(is_vms)))+
geom_point()+
geom_line()+
labs(x="Date",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Month, all Tickets")
landings_by_year <- vms_fishtix_join %>%
group_by(year,is_vms) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup()
landings_by_year %>%
ggplot(aes(year,DCRB_lbs/1e6,col=factor(is_vms)))+
geom_point()+
geom_line()+
ylim(0,NA)+
labs(x="Year",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Year, all Tickets")
landings_by_month %>%
ggplot(aes(date,DCRB_lbs/1e6,col=factor(is_vms)))+
geom_point()+
geom_line()+
scale_color_aaas(labels=c("No VMS","VMS"),name="")
landings_by_month <- vms_fishtix_join %>%
group_by(year,month,is_vms) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup() %>%
mutate(day=1) %>%
unite(date,year,month,day,sep="-",remove = FALSE) %>%
mutate(date=as_date(date,format="%Y-%m-%d",tz="America/Los_Angeles"))
landings_by_month %>%
ggplot(aes(date,DCRB_lbs/1e6,col=factor(is_vms)))+
geom_point()+
geom_line()+
scale_color_aaas(labels=c("No VMS","VMS"),name="")+
labs(x="Date",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Month, all Tickets")
landings_by_year <- vms_fishtix_join %>%
group_by(year,is_vms) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup()
landings_by_year %>%
ggplot(aes(year,DCRB_lbs/1e6,col=factor(is_vms)))+
geom_point()+
geom_line()+
ylim(0,NA)+
scale_color_aaas(labels=c("No VMS","VMS"),name="")
labs(x="Year",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Year, all Tickets")
landings_by_month <- vms_fishtix_join %>%
group_by(year,month,is_vms) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup() %>%
mutate(day=1) %>%
unite(date,year,month,day,sep="-",remove = FALSE) %>%
mutate(date=as_date(date,format="%Y-%m-%d",tz="America/Los_Angeles"))
landings_by_month %>%
ggplot(aes(date,DCRB_lbs/1e6,col=factor(is_vms)))+
geom_point()+
geom_line()+
scale_color_aaas(labels=c("No VMS","VMS"),name="")+
labs(x="Date",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Month, all Tickets")
landings_by_year <- vms_fishtix_join %>%
group_by(year,is_vms) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup()
landings_by_year %>%
ggplot(aes(year,DCRB_lbs/1e6,col=factor(is_vms)))+
geom_point()+
geom_line()+
ylim(0,NA)+
scale_color_aaas(labels=c("No VMS","VMS"),name="")+
labs(x="Year",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Year, all Tickets")
fishtix %>% filter(year==2009) %>% summarise(totlbs=sum(DCRB..lbs.))
fishtix %>% filter(year==2009) %>% summarise(totlbs=sum(DCRB..lbs.))/1e6
landings_by_month <- vms_fishtix_join %>%
group_by(year,month,is_vms) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup() %>%
# add a total monthly landings column
group_by(year,month) %>%
mutate(tot_month=sum(DCRB..lbs.)) %>%
ungroup() %>%
# add the date back in for plotting purposes
mutate(day=1) %>%
unite(date,year,month,day,sep="-",remove = FALSE) %>%
mutate(date=as_date(date,format="%Y-%m-%d",tz="America/Los_Angeles"))
landings_by_month <- vms_fishtix_join %>%
# add a total monthly landings column
group_by(year,month) %>%
mutate(tot_month=sum(DCRB..lbs.)) %>%
ungroup() %>%
group_by(year,month,is_vms) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup() %>%
# add the date back in for plotting purposes
mutate(day=1) %>%
unite(date,year,month,day,sep="-",remove = FALSE) %>%
mutate(date=as_date(date,format="%Y-%m-%d",tz="America/Los_Angeles"))
landings_by_month %>%
ggplot(aes(date,DCRB_lbs/1e6,col=factor(is_vms)))+
geom_point()+
geom_line()+
geom_line(aes(date,tot_month))+
geom_point(aes(date,tot_month))+
scale_color_aaas(labels=c("No VMS","VMS"),name="")+
labs(x="Date",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Month, all Tickets")
landings_by_month <- vms_fishtix_join %>%
group_by(year,month,is_vms) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup() %>%
mutate(day=1) %>%
unite(date,year,month,day,sep="-",remove = FALSE) %>%
mutate(date=as_date(date,format="%Y-%m-%d",tz="America/Los_Angeles"))
landings_by_month %>%
ggplot(aes(date,DCRB_lbs/1e6,col=factor(is_vms)))+
geom_point()+
geom_line()+
scale_color_aaas(labels=c("No VMS","VMS"),name="")+
labs(x="Date",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Month, all Tickets")
landings_by_year <- vms_fishtix_join %>%
group_by(year,is_vms) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup()
landings_by_year %>%
ggplot(aes(year,DCRB_lbs/1e6,col=factor(is_vms)))+
geom_point()+
geom_line()+
ylim(0,NA)+
scale_color_aaas(labels=c("No VMS","VMS"),name="")
labs(x="Year",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Year, all Tickets")
landings_by_month <- vms_fishtix_join %>%
group_by(year,month,is_vms) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup() %>%
mutate(day=1) %>%
unite(date,year,month,day,sep="-",remove = FALSE) %>%
mutate(date=as_date(date,format="%Y-%m-%d",tz="America/Los_Angeles"))
landings_by_month %>%
ggplot(aes(date,DCRB_lbs/1e6,col=factor(is_vms)))+
geom_point()+
geom_line()+
scale_color_aaas(labels=c("No VMS","VMS"),name="")+
labs(x="Date",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Month, all Tickets")
landings_by_year <- vms_fishtix_join %>%
group_by(year,is_vms) %>%
summarise(DCRB_lbs=sum(DCRB..lbs.)) %>%
mutate(DCRB_mt=DCRB_lbs/2204.62) %>%
ungroup()
landings_by_year %>%
ggplot(aes(year,DCRB_lbs/1e6,col=factor(is_vms)))+
geom_point()+
geom_line()+
ylim(0,NA)+
scale_color_aaas(labels=c("No VMS","VMS"),name="")+
labs(x="Year",y="DCRB Landings (Million Lbs)",title="DCRB Landings by Year, all Tickets")
